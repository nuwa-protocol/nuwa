---
title: "MCP Proxy"
description: "Turn an existing MCP into a pay‑per‑call service using the Nuwa MCP Server Proxy"
---

With Nuwa MCP Proxy, you can convert an existing MCP server (HTTP/stream or stdio) into a Nuwa‑Compatible, pay‑per‑call service without changing the upstream code. The proxy exposes a single JSON‑RPC endpoint (`/mcp`) over streamable HTTP, forwards tools, and attaches Nuwa payment semantics.

<Note>
Nuwa MCP Proxy is designed to be single-server, single-endpoint MCP server. For multiple MCP servers, you have to deploy multiple Nuwa MCP Proxy instances.
</Note>

## Quick start

<Steps>
<Step title="Install and build">

you can find the full implementation of [Nuwa MCP Proxy on Github](https://github.com/nuwa-protocol/nuwa/tree/main/nuwa-services/mcp-server-proxy).

```bash
cd nuwa-services/mcp-server-proxy
pnpm install
pnpm build
```

</Step>

<Step title="Create a config.yaml">

```yaml
# Minimal proxy config
port: 8088
endpoint: "/mcp"

# Upstream MCP (http stream or stdio)
upstream:
  type: "httpStream"
  url: "https://api.example.com/mcp"
  # Optional auth to upstream
  auth:
    scheme: "bearer"
    token: "${UPSTREAM_API_TOKEN}"

# Payment & network
serviceId: "my-mcp-service"
serviceKey: "${SERVICE_KEY}"
network: "test"
defaultPricePicoUSD: "100000000"   # 0.0001 USD
debug: false

# Optional per-tool pricing (overrides default)
register:
  tools:
    - name: "example.search"
      pricePicoUSD: "200000000"     # 0.0002 USD
```

</Step>

<Step title="Run the proxy">

```bash
export SERVICE_KEY=...          # required for settlement
export UPSTREAM_API_TOKEN=...   # if your upstream requires it

node dist/index.js --config ./config.yaml
# -> serves POST /mcp (JSON-RPC over streamable HTTP)
```

</Step>

<Step title="Verify the proxied MCP server">

You can use the [MCP Debug tool](https://test-app.nuwa.dev/cap-studio/mcp) provided by Cap Studio to verify and debug the proxied MCP server.

</Step>
</Steps>

## Upstream modes

<Tabs>
<Tab title="httpStream">

```yaml
upstream:
  type: "httpStream"
  url: "https://api.example.com/mcp"
  auth:
    scheme: "bearer"
    token: "${UPSTREAM_API_TOKEN}"
```

</Tab>
<Tab title="stdio">

```yaml
upstream:
  type: "stdio"
  command: ["npx", "-y", "@vendor/your-mcp@latest"]
  env:
    API_KEY: "${UPSTREAM_API_KEY}"
```

</Tab>
</Tabs>



## Preconfigured examples

Two ready-to-run examples are included in `nuwa-services/mcp-server-proxy`:

<Tabs>
<Tab title="Amap proxy (HTTP upstream)">

```bash
cd nuwa-services/mcp-server-proxy
export AMAP_API_KEY=your_amap_api_key_here
export SERVICE_KEY=your_service_key_here

# Optional: set a port (defaults in script)
export PORT=8088

./examples/run-amap-local.sh
# → Serves /mcp on http://localhost:8088
```

Config reference: `deployments/instances/amap-proxy/config.yaml`

</Tab>

<Tab title="Context7 proxy (stdio upstream)">

```bash
cd nuwa-services/mcp-server-proxy
export SERVICE_KEY=your_service_key_here

# Optional: set a port (defaults in script)
export PORT=8089

./examples/run-context7-local.sh
# → Serves /mcp on http://localhost:8089
```

Config reference: `deployments/instances/context7-proxy/config.yaml`

</Tab>
</Tabs>


## Relevant Docs

<CardGroup cols={2}>
    <Card title="MCP Pricing" icon="dollar-sign" href="/build-caps/mcp-pricing">
      Pricing for MCP tools
    </Card>
    <Card title="MCP Server" icon="server" href="/build-caps/mcp-server">
      Build a pay‑per‑call MCP server directly using the Payment Kit.
    </Card>
</CardGroup>


